package checker


poll() {
	switch type {
	case tcp
		interface tcp.init
	}
	intergace

}

runpollWrotker

putpoolkTask

waitpoolTask

Check() {
	for checkerConfig {
		targetList {
			putPollTask
		}
		targetList {
			waitPollTask
		}
		eval
	}
}



checkRecord() {
	targetList {
		putPollTask
	}
	targetList {
		waitPollTask
	}
	eval
}

runcheckrecordWrotker

putcheckrecordTask

waitcheckrecordTask

Check() {
	for checkerConfig {
		putcheckRecordTasl
	}
	for checkerConfig {
		waitcheckRecordTasl
	}
}

"checker" : [
{
     "name": 2.2.2.2
     "type": 2.2.2.2
     "content": 2.2.2.2
     "targetList"[
        {a, tcp_conn 2.2.2.2:80},
        {b, http_status 2.2.2.2:80},
        {c, https_status 2.2.2.2:80},
        {d, tcp_regex 2.2.2.2:80},
        {e, http_status_regex 2.2.2.2:80},
        {f, https_status_regex 2.2.2.2:80},
        {g, icmp 3.3.3.3.3},
     ]
     "eval" :  "a & (b & c) & d | (c|f)"
},
]


