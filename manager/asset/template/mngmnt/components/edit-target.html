<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/mat-elements/mat-button.html">
<link rel="import" href="../../bower_components/paper-datatable-api/paper-datatable-api-column.html">
<link rel="import" href="../../bower_components/paper-datatable-api/paper-datatable-api.html">


<dom-module id="edit-target">
	<template>
		<style>
			mat-button {
				border: 1px;
				border-style: groove;
			}
		</style>
		<div>
			<mat-button class="add-target" label="add target"></mat-button>
		</div>
		<div>
			<paper-datatable-api class="edit-target">
				<paper-datatable-api-column draggable-column header="Fruit" property="fruit">
					<template>
						<span>{{value}}</span>
					</template>
				</paper-datatable-api-column>
				<paper-datatable-api-column header="Color" property="color">
					<template>
						<span>{{value}}</span>
					</template>
				</paper-datatable-api-column>
			</paper-datatable-api>
		</div>
		<iron-ajax 
	  	    with-credentials
		    url="./api/config"
		    method="GET"
		    handle-as="json"
		    on-response="_response"
		    on-error="_error">
		</iron-ajax>
	</template>
	<script>
		Polymer({
			is: 'edit-target',
			listeners: {
			    'xp-activate': '_click'
			},
			refresh: function(e) {
				console.log("refresh");
				// irom-ajax.generateRequest()
			},
			_click: function(e) {
				console.log("click");
				console.log(e);
			},
			_response: function(e) { 
				console.log("response");
				var newData = []
				for (key in e.detail.xhr.response.watcher.zoneMap) {
					var zone = e.detail.xhr.response.watcher.zoneMap[key]
					newData.push({
						domain: key,
						primaryNameServer: zone.primaryNameServer,
						email: zone.email,
						nameServerList: zone.nameServerList.length,
						staticRecordList: zone.staticRecordList.length,
						dynamicGroupMap: Object.keys(zone.dynamicGroupMap).length
					})

				}
				console.log(newData)
				// grid property change
			},
			_error: function(e) {
				console.log("error");
				console.error(e);
			}
		});
	</script>
</dom-module>
